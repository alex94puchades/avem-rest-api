{"version":3,"sources":["lib/models/Client.js"],"names":[],"mappings":";;;;;;;;oBAAiB,MAAM;;;;qBACL,OAAO;;;;wBACM,UAAU;;;;uBAErB,WAAW;;;;sBACZ,iBAAiB;;;;AAEpC,SAAS,YAAY,GAAG;AACvB,QAAO,uBAAK,oBAAO,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;CAChD;;AAED,IAAM,YAAY,GAAG,IAAI,sBAAS,MAAM,CAAC;AACxC,KAAI,EAAE;AACL,MAAI,EAAE,MAAM;AACZ,QAAM,EAAE,IAAI;AACZ,UAAQ,EAAE,IAAI;EACd;AACD,OAAM,EAAE;AACP,MAAI,EAAE,MAAM;AACZ,UAAQ,EAAE,IAAI;AACd,aAAS,YAAY;EACrB;AACD,QAAO,EAAE;AACR,MAAI,EAAE,OAAO;AACb,aAAS,KAAK;AACd,UAAQ,EAAE,IAAI;EACd;AACD,YAAW,EAAE;AACZ,MAAI,EAAE,MAAM;EACZ;CACD,CAAC,CAAC;;AAEH,YAAY,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAS,IAAI,EAAE;AACzC,sBAAQ,IAAI,CAAC,EAAE,WAAW,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,UAAC,GAAG,EAAE,OAAO,EAAK;AACzD,MAAI,GAAG,EAAE,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC;AAC1B,qBAAM,IAAI,CAAC,OAAO,EAAE,UAAC,OAAO,EAAE,IAAI;UAAK,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC;GAAA,CAAC,CAAC;EAC7D,CAAC,CAAC;CACH,CAAC,CAAC;;qBAEY,sBAAS,KAAK,CAAC,QAAQ,EAAE,YAAY,CAAC","file":"lib/models/Client.js","sourcesContent":["import uid2 from 'uid2';\nimport async from 'async';\nimport mongoose, {Schema} from 'mongoose';\n\nimport Session from './Session';\nimport config from '../../../config';\n\nfunction randomSecret() {\n\treturn uid2(config.oauth2.client.secret.length);\n}\n\nconst clientSchema = new mongoose.Schema({\n\tname: {\n\t\ttype: String,\n\t\tunique: true,\n\t\trequired: true,\n\t},\n\tsecret: {\n\t\ttype: String,\n\t\trequired: true,\n\t\tdefault: randomSecret,\n\t},\n\ttrusted: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t\trequired: true,\n\t},\n\tredirectUri: {\n\t\ttype: String,\n\t},\n});\n\nclientSchema.pre('remove', function(next) {\n\tSession.find({ clientOwner: this._id }, (err, results) => {\n\t\tif (err) return next(err);\n\t\tasync.each(results, (session, next) => session.remove(next));\n\t});\n});\n\nexport default mongoose.model('Client', clientSchema);\n"],"sourceRoot":"/source/"}