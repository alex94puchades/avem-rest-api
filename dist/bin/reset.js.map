{"version":3,"sources":["bin/reset.js"],"names":[],"mappings":";;;;kBAAe,IAAI;;;;oBACF,MAAM;;;;uBACP,UAAU;;;;wBACL,UAAU;;;;sBAEZ,cAAc;;;;AAEjC,IAAI;AACH,QAAO,CAAC,GAAG,CAAC,kEAAkE,CAAC,CAAC;AAChF,QAAO,CAAC,GAAG,CAAC,4EAA4E,CAAC,CAAC;AAC1F,KAAI,QAAQ,GAAG,qBAAI,MAAM,CAAC,oCAAoC,EAAE,EAAE,MAAM,EAAE,CAAC,KAAK,EAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC;AAC5F,KAAI,QAAQ,KAAK,KAAK,EAAE;AACvB,SAAO,CAAC,GAAG,EAAE,CAAC;AACd,qBAAmB,EAAE,CAAC;AACtB,sBAAoB,EAAE,CAAC;AACvB,SAAO,CAAC,GAAG,EAAE,CAAC;AACd,SAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACpB,MAAM;AACN,SAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;EAC5B;CACD,CAAC,OAAO,CAAC,EAAE;AACX,QAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC;CAC1C;;AAED,SAAS,eAAe,CAAC,QAAQ,EAAE;AAClC,QAAO,sBAAS,gBAAgB,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;CACrD;;AAED,SAAS,mBAAmB,GAAG;AAC9B,QAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;AACpC,KAAI,IAAI,GAAG,eAAe,CAAC,oBAAO,EAAE,CAAC,CAAC;AACtC,KAAI,CAAC,EAAE,CAAC,MAAM,EAAE,YAAM;AACrB,MAAI,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC;AACvB,MAAI,CAAC,KAAK,EAAE,CAAC;EACb,CAAC,CAAC;CACH;;AAED,SAAS,oBAAoB,GAAG;AAC/B,QAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;AACrC,iBAAG,UAAU,CAAC,WAAW,CAAC,CAAC;AAC3B,KAAI,gBAAG,UAAU,CAAC,eAAe,CAAC,EACjC,gBAAG,UAAU,CAAC,eAAe,CAAC,CAAC;CAChC","file":"bin/reset.js","sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport ask from 'ask-sync';\nimport mongoose from 'mongoose';\n\nimport config from '../../config';\n\ntry {\n\tconsole.log('This script will remove your config files and erase the database');\n\tconsole.log('Make sure you have a backup of everything, as this action cannot be undone');\n\tlet response = ask.string('Are you sure you want to continue?', { values: ['yes','no'] })();\n\tif (response === 'yes') {\n\t\tconsole.log();\n\t\tresetDatabaseSchema();\n\t\tremoveConfigSettings();\n\t\tconsole.log();\n\t\tconsole.log('Done');\n\t} else {\n\t\tconsole.log('Nothing done');\n\t}\n} catch (e) {\n\tconsole.log('Fatal error: %s', e.message);\n}\n\nfunction databaseConnect(settings) {\n\treturn mongoose.createConnection(settings.mongo.url);\n}\n\nfunction resetDatabaseSchema() {\n\tconsole.log('Erasing the database');\n\tlet conn = databaseConnect(config.db);\n\tconn.on('open', () => {\n\t\tconn.db.dropDatabase();\n\t\tconn.close();\n\t});\n}\n\nfunction removeConfigSettings() {\n\tconsole.log('Removing config files');\n\tfs.unlinkSync('config.js');\n\tif (fs.existsSync('config.js.old'))\n\t\tfs.unlinkSync('config.js.old');\n}\n"],"sourceRoot":"/source/"}